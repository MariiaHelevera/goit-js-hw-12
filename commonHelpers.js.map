{"version":3,"file":"commonHelpers.js","sources":["../src/main.js"],"sourcesContent":["import iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\nimport axios from 'axios';\n\nconst form = document.querySelector('.search-form');\nconst gallery = document.getElementById('gallery');\nconst loader = document.querySelector('.loader');\nconst loadMoreBtn = document.querySelector('.load-more-btn');\n\nconst lightBox = new SimpleLightbox('.gallery-link');\n\nlet currentPage = 1;\nconst perPage = 15;\nlet totalHits = 0;\n\n\nlet searchParams = {\n  key: '42334155-d8ef6d202703fa7fdc7903459',\n  image_type: 'photo',\n  orientation: 'horizontal',\n  safesearch: true,\n  q: '',\n  page: currentPage,\n  per_page: perPage\n};\n\nform.addEventListener('submit', async function (e) {\n  e.preventDefault();\n  loader.style.display = 'block';\n  const inputValue = e.target.elements.input.value;\n  searchParams.q = inputValue;\n  searchParams.page = 1;\n  currentPage = 1;\n  loadMoreBtn.style.display = 'none';\n  try {\n    const images = await getPhotoByKeyword();\n    totalHits = images.totalHits;\n    createGallery(images);\n  } catch (error) {\n    console.log(error);\n  }\n  e.target.reset();\n});\n\nasync function getPhotoByKeyword() {\n  const urlParams = new URLSearchParams(searchParams);\n  try {\n    const response = await axios.get(`https://pixabay.com/api/?${urlParams}`);\n    return response.data;\n  } catch (error) {\n    throw new Error(error.response.status);\n  }\n}\n\nloadMoreBtn.addEventListener('click', async function () {\n  loader.style.display = 'block';\n  searchParams.page += 1;\n  try {\n    const images = await getPhotoByKeyword();\n    if (images.hits.length > 0) {\n      loader.style.display = 'block';\n      appendToGallery(images);\n      scrollToNextPage();\n      currentPage += 1;\n      searchParams.page = currentPage;\n    } else {\n      loadMoreBtn.style.display = 'none';\n      iziToast.show({\n        message: \"We're sorry, but there are no more results to display.\",\n        messageColor: '#FFFFFF',\n        backgroundColor: '#EF4040',\n        position: 'topRight',\n        messageSize: '16px',\n        messageLineHeight: '24px',\n        maxWidth: '432px',\n      });\n    }\n  } catch (error) {\n    iziToast.error({\n      title: 'Error',\n      message: 'An error occurred while fetching images. Please try again later.',\n      position: 'topRight',\n      timeout: 5000\n    });\n    console.error(error);\n  } finally {\n    loader.style.display = 'none';\n  }\n});\n\n\nfunction createGallery(images) {\n  if (images.hits.length === 0) {\n    iziToast.show({\n      message:\n        'Sorry, there are no images matching your search query. Please try again!',\n      messageColor: '#FFFFFF',\n      backgroundColor: '#EF4040',\n      position: 'topRight',\n      messageSize: '16px',\n      messageLineHeight: '24px',\n      maxWidth: '432px',\n    });\n    gallery.innerHTML = '';\n    loadMoreBtn.style.display = 'none';\n  } else {\n    const link = images.hits\n      .map(\n        image => `<a class=\"gallery-link\" href=\"${image.largeImageURL}\">\n        <img class=\"gallery-image\"\n        src=\"${image.webformatURL}\"\n        alt=\"${image.tags}\"\n         </a>\n         <div class=\"image-info\">\n          <p ><strong>Likes:</strong> <span class=\"text\">${image.likes}</span></p>\n          <p ><strong>Views:</strong> <span class=\"text\">${image.views}</span></p>\n          <p ><strong>Comments:</strong> <span class=\"text\">${image.comments}</span></p>\n          <p ><strong>Downloads:</strong> <span class=\"text\">${image.downloads}</span></p>\n          </div>`\n      )\n      .join('');\n\n    gallery.innerHTML = link;\n\n    if (totalHits <= currentPage * perPage) {\n      loadMoreBtn.style.display = 'none';\n      iziToast.show({\n        message: \"We're sorry, but you've reached the end of search results.\",\n        messageColor: '#FFFFFF',\n        backgroundColor: '#EF4040',\n        position: 'topRight',\n        messageSize: '16px',\n        messageLineHeight: '24px',\n        maxWidth: '432px',\n      });\n    } else {\n      loadMoreBtn.style.display = 'block';\n    }\n  }\n\n  lightBox.refresh();\n  loader.style.display = 'none';\n}\n\nfunction appendToGallery(images) {\n  const link = images.hits\n    .map(\n      image => `<a class=\"gallery-link\" href=\"${image.largeImageURL}\">\n        <img class=\"gallery-image\"\n        src=\"${image.webformatURL}\"\n        alt=\"${image.tags}\"\n         </a>\n         <div class=\"image-info\">\n          <p ><strong>Likes:</strong> <span class=\"text\">${image.likes}</span></p>\n          <p ><strong>Views:</strong> <span class=\"text\">${image.views}</span></p>\n          <p ><strong>Comments:</strong> <span class=\"text\">${image.comments}</span></p>\n          <p ><strong>Downloads:</strong> <span class=\"text\">${image.downloads}</span></p>\n          </div>`\n    )\n    .join('');\n  gallery.innerHTML += link;\n  lightBox.refresh();\n  loader.style.display = 'none';\n}\n\nfunction scrollToNextPage() {\n  const galleryItemHeight = document.querySelector('.gallery-link').getBoundingClientRect().height;\n\n  window.scrollBy({\n    top: galleryItemHeight * 3,\n    behavior: 'smooth'\n  });\n}"],"names":["form","gallery","loader","loadMoreBtn","lightBox","SimpleLightbox","currentPage","perPage","totalHits","searchParams","e","inputValue","images","getPhotoByKeyword","createGallery","error","urlParams","axios","appendToGallery","scrollToNextPage","iziToast","link","image","galleryItemHeight"],"mappings":"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"}